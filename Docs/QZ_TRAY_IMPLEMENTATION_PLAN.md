# ‚úÖ –ü–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø–ª–∞–Ω –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è QZ Tray

## üìã –©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ:

### 1. ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- `client/lib/qzConfig.ts` - –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è QZ Tray –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤
- `server/routes/qz-tray.ts` - —Å–µ—Ä–≤–µ—Ä–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –¥–ª—è –ø—ñ–¥–ø–∏—Å—É —Ç–∞ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤
- –û–Ω–æ–≤–ª–µ–Ω–æ `client/services/printerService.ts` –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- –î–æ–¥–∞–Ω–æ —Ä–æ—É—Ç–∏ –≤ `server/index.ts`

### 2. ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–∏
- `scripts/generate-qz-certificate.ps1` - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤
- `scripts/test-qz-connection.ps1` - —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
- –î–æ–¥–∞–Ω–æ npm –∫–æ–º–∞–Ω–¥–∏: `npm run qz:test` —Ç–∞ `npm run qz:cert`

### 3. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- `Docs/QZ_TRAY_SETUP.md` - –ø–æ–≤–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
- `Docs/QZ_TRAY_QUICKSTART.md` - —à–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç
- –û–Ω–æ–≤–ª–µ–Ω–æ `.gitignore` –¥–ª—è –±–µ–∑–ø–µ–∫–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤

---

## üöÄ –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞—Ä–∞–∑:

### –í–∞—Ä—ñ–∞–Ω—Ç –ê: –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç (–±–µ–∑ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ - –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏)

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ QZ Tray
1. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ https://qz.io/download/
2. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–∞ Windows
3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ (–º–∞—î –∑'—è–≤–∏—Ç–∏—Å—è —ñ–∫–æ–Ω–∫–∞ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É —Ç—Ä–µ—ó)

#### –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
```powershell
npm run qz:test
```

–ú–∞—î –≤–∏–π—Ç–∏: `‚úÖ QZ Tray –ø—Ä–∞—Ü—é—î!`

#### –ö—Ä–æ–∫ 3: –ì–æ—Ç–æ–≤–æ!
–í–∞—à –¥–æ–¥–∞—Ç–æ–∫ –≤–∂–µ –≥–æ—Ç–æ–≤–∏–π –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ QZ Tray –≤ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏.

---

### –í–∞—Ä—ñ–∞–Ω—Ç –ë: –ü—Ä–æ–¥–∞–∫—à–Ω (–∑ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞–º–∏)

#### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ OpenSSL
```powershell
# –ß–µ—Ä–µ–∑ Chocolatey
choco install openssl

# –ê–±–æ —á–µ—Ä–µ–∑ Scoop
scoop install openssl

# –ê–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ https://slproweb.com/products/Win32OpenSSL.html
```

#### –ö—Ä–æ–∫ 2: –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
```powershell
npm run qz:cert
```

–°–ª—ñ–¥—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º –Ω–∞ –µ–∫—Ä–∞–Ω—ñ. –°–∫—Ä–∏–ø—Ç —Å—Ç–≤–æ—Ä–∏—Ç—å:
- `certificates/private-key.pem` - –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á
- `certificates/digital-certificate.crt` - —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç (CRT)
- `certificates/digital-certificate.pem` - —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç (PEM)

#### –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
–°—Ç–≤–æ—Ä–∏—Ç–∏ `.env.local`:
```env
VITE_QZ_USE_SERVER_SIGNING=true
```

#### –ö—Ä–æ–∫ 4: –ü–µ—Ä–µ–±—É–¥—É–≤–∞—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏
```powershell
npm run rebuild
npm start
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
```powershell
npm run qz:test
```

### –¢–µ—Å—Ç –¥—Ä—É–∫—É –≤ –∫–æ–¥—ñ
```typescript
import printerService from './services/printerService';

// 1. –ó–Ω–∞–π—Ç–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∏
const printers = await printerService.findPrinters();
console.log('–î–æ—Å—Ç—É–ø–Ω—ñ –ø—Ä–∏–Ω—Ç–µ—Ä–∏:', printers);

// 2. –î—Ä—É–∫ ZPL –º—ñ—Ç–∫–∏
const testZpl = `
^XA
^FO50,50^ADN,36,20^FD–¢–ï–°–¢ –î–†–£–ö–£^FS
^FO50,100^ADN,36,20^FD–¶–µ –ø—Ä–∞—Ü—é—î!^FS
^XZ
`;

await printerService.printZpl(printers[0].name, testZpl);
```

---

## üìö API Endpoints (—Å—Ç–≤–æ—Ä–µ–Ω–æ)

### `POST /api/qz-tray/sign`
–ü—ñ–¥–ø–∏—Å—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è QZ Tray (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ).

**Request:**
```json
{
  "message": "string to sign"
}
```

**Response:**
```json
{
  "signature": "base64 signature",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### `GET /api/qz-tray/certificate`
–ü–æ–≤–µ—Ä—Ç–∞—î –ø—É–±–ª—ñ—á–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç.

**Response:**
```json
{
  "certificate": "-----BEGIN CERTIFICATE-----...",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### `GET /api/qz-tray/status`
–ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏.

**Response:**
```json
{
  "configured": true,
  "certificate": true,
  "privateKey": true,
  "message": "QZ Tray –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ"
}
```

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "QZ Tray –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è"
**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ QZ Tray (–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É —Ç—Ä–µ—ó)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–∏: `npm run qz:test`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ QZ Tray
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–∞—î—Ä–≤–æ–ª

### –ü—Ä–æ–±–ª–µ–º–∞: "Certificate error"
**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç: `npm run qz:cert`
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ —Ñ–∞–π–ª–∏ –≤ `certificates/` —Å—Ç–≤–æ—Ä–µ–Ω—ñ
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü—Ä–∏–Ω—Ç–µ—Ä –Ω–µ –¥—Ä—É–∫—É—î"
**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –ø—Ä–∏–Ω—Ç–µ—Ä –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ —Å–∏—Å—Ç–µ–º–∏
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –ø—Ä–∏–Ω—Ç–µ—Ä –≤–∏–¥–Ω–æ –≤ `await printerService.findPrinters()`
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç ZPL –∫–æ–¥—É
4. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞

---

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ QZ Tray** –Ω–∞ –≤—Å—ñ—Ö —Ä–æ–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü—ñ—è—Ö
2. **–î–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏**: –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ QZ Tray - –≤—Å–µ –≤–∂–µ –ø—Ä–∞—Ü—é—î
3. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**: –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
4. **–ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫** QZ Tray (–¥–æ–¥–∞—Ç–∏ –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ Windows)

---

## üìñ –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- –û—Ñ—ñ—Ü—ñ–π–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: https://qz.io/wiki/
- –ü—Ä–∏–∫–ª–∞–¥–∏: https://qz.io/wiki/examples/
- GitHub: https://github.com/qzind/tray
- –ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: `Docs/QZ_TRAY_SETUP.md`
- –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç: `Docs/QZ_TRAY_QUICKSTART.md`

---

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏:
1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ `Docs/QZ_TRAY_SETUP.md` (—Ä–æ–∑–¥—ñ–ª Troubleshooting)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É: `npm run qz:test`
3. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ QZ Tray logs (—á–µ—Ä–µ–∑ —ñ–∫–æ–Ω–∫—É –≤ —Ç—Ä–µ—ó ‚Üí View Logs)

---

**–°—Ç–≤–æ—Ä–µ–Ω–æ:** ${new Date().toLocaleDateString('uk-UA')}
**–í–µ—Ä—Å—ñ—è QZ Tray:** 2.2.5
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

