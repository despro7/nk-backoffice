# üìù –†–µ–∑—é–º–µ: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥–æ–¥–∏–Ω–∏ –∑–≤—ñ—Ç–Ω–æ–≥–æ –¥–Ω—è

## ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

### 1Ô∏è‚É£ Backend API –ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏
**–§–∞–π–ª:** `server/routes/settings.ts`

- ‚úÖ **GET `/api/settings/reporting-day-start-hour`** - –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
- ‚úÖ **PUT `/api/settings/reporting-day-start-hour`** - –û–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è: —á–∞—Å–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è 0-23
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è: ‚úÖ –û–±–æ–≤'—è–∑–∫–æ–≤–∞ –¥–ª—è –æ–±–æ—Ö –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤

### 2Ô∏è‚É£ –£—Ç—ñ–ª—ñ—Ç–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –¥–∞—Ç
**–§–∞–π–ª:** `server/lib/utils.ts`

```typescript
// –û—Ç—Ä–∏–º–∞—Ç–∏ —á–∞—Å –ø–æ—á–∞—Ç–∫—É –∑–≤—ñ—Ç–Ω–æ–≥–æ –¥–Ω—è
export async function getReportingDayStartHour(): Promise<number>

// –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–≤—ñ—Ç–Ω—É –¥–∞—Ç—É –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
export function getReportingDate(orderDate: Date, dayStartHour: number = 0): string

// –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä—É –∑–≤—ñ—Ç—ñ–≤
export function getReportingDateRange(reportingDate: string, dayStartHour: number = 0): { start: Date; end: Date }
```

**–õ–æ–≥—ñ–∫–∞:**
- –Ø–∫—â–æ —á–∞—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è < dayStartHour ‚Üí –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –¥–µ–Ω—å
- –Ø–∫—â–æ —á–∞—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚â• dayStartHour ‚Üí –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ –ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–Ω—å

### 3Ô∏è‚É£ –ú–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –∑–≤—ñ—Ç–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏
**–§–∞–π–ª:** `server/routes/orders.ts`

–û–Ω–æ–≤–ª–µ–Ω–æ 4 –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `dayStartHour`:

1. **GET `/api/orders/products/stats`** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–æ–≤–∞—Ä–∞–º
2. **GET `/api/orders/products/stats/dates`** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑ —Ä–æ–∑–±–∏–≤–∫–æ—é –ø–æ –¥–∞—Ç–∞—Ö
3. **GET `/api/orders/products/chart`** - –î–∞–Ω—ñ –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—É
4. **GET `/api/orders/sales/report`** - –ó–≤—ñ—Ç –ø—Ä–æ –ø—Ä–æ–¥–∞–∂–∏

**–ó–º—ñ–Ω–∏:**
- –î–æ–¥–∞–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è `dayStartHour` –Ω–∞ –ø–æ—á–∞—Ç–∫—É –∫–æ–∂–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó
- –ó–∞–º—ñ–Ω–µ–Ω–æ –ø—Ä—è–º–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥–∞—Ç –Ω–∞ `getReportingDate()`
- –ó–∞–º—ñ–Ω–µ–Ω–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ –Ω–∞ `getReportingDateRange()`

### 4Ô∏è‚É£ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
**–§–∞–π–ª:** `client/components/ReportingDayStartHourSettings.tsx`

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:**
- üìä –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
- üéõÔ∏è Select –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤–∏–±–æ—Ä—É –≥–æ–¥–∏–Ω–∏ (0-23)
- ‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ –≤–ø–ª–∏–≤ –Ω–∞ –∑–≤—ñ—Ç–∏
- üìù –ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –∑–∞–º–æ–≤–ª–µ–Ω—å
- ‚úÖ/‚ùå –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö/–ø–æ–º–∏–ª–∫—É
- üîÑ –°—Ç–∞–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è

### 5Ô∏è‚É£ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å
**–§–∞–π–ª:** `client/pages/SettingsAdmin.tsx`

- ‚úÖ –î–æ–¥–∞–Ω–æ –Ω–æ–≤–∏–π —Ä–æ–∑–¥—ñ–ª "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤"
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `ReportingDayStartHourSettings` —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–π

### 6Ô∏è‚É£ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
**–§–∞–π–ª—Å:** `Docs/REPORTING_DAY_START_HOUR.md`

- üìñ –ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- üìã –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- üîê –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –±–µ–∑–ø–µ–∫—É
- üß™ –¢–µ—Å—Ç–æ–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó
- üìö –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å —Ç–∞ –ø—Ä–∏–º—ñ—Ç–∫–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –©–æ –ø—Ä–∞—Ü—é—î:

```
–Ø–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ dayStartHour = 16:

–ó–≤—ñ—Ç–Ω–∏–π –¥–µ–Ω—å 18 –∂–æ–≤—Ç–Ω—è:
‚îú‚îÄ –ü–æ—á–∞—Ç–æ–∫: 17.10 16:00:01
‚îú‚îÄ –ö—ñ–Ω–µ—Ü—å: 18.10 16:00:00
‚îî‚îÄ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—è—é—Ç—å—Å—è –∑–∞ —Ü–∏–º –ø—Ä–∞–≤–∏–ª–æ–º
```

### –ü—Ä–∏–∫–ª–∞–¥ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

1. **–ü–µ—Ä–µ–π—Ç–∏ –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å** ‚Üí –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ‚Üí –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤
2. **–í–∏–±—Ä–∞—Ç–∏ –≥–æ–¥–∏–Ω—É** (0-23)
3. **–ó–±–µ—Ä–µ–≥—Ç–∏** 
4. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–≤—ñ—Ç–∏** - –≤–æ–Ω–∏ –ø–µ—Ä–µ—Å—Ä–∞–Ω—É—é—Ç—å—Å—è –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –Ω–æ–≤–æ—ó –≥–æ–¥–∏–Ω–∏

## üìä –§–∞–π–ª–∏, —â–æ –±—É–ª–∏ –∑–º—ñ–Ω–µ–Ω—ñ:

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å |
|---|---|---|
| `server/routes/settings.ts` | ‚úÖ –î–æ–¥–∞–Ω–æ | API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ |
| `server/lib/utils.ts` | ‚úÖ –î–æ–¥–∞–Ω–æ | –£—Ç—ñ–ª—ñ—Ç–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É |
| `server/routes/orders.ts` | ‚úÖ –ú–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ | 4 –∑–≤—ñ—Ç–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ |
| `client/components/ReportingDayStartHourSettings.tsx` | ‚úÖ –î–æ–¥–∞–Ω–æ | React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç |
| `client/pages/SettingsAdmin.tsx` | ‚úÖ –ú–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ | –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| `prisma/migrations/add_reporting_day_start_hour.sql` | ‚úÖ –î–æ–¥–∞–Ω–æ | –ú—ñ–≥—Ä–∞—Ü—ñ—è –ë–î |
| `Docs/REPORTING_DAY_START_HOUR.md` | ‚úÖ –î–æ–¥–∞–Ω–æ | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è |

## üîÑ –ü—Ä–æ—Ü–µ—Å —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –ë–î
npm run migrate

# 2. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
npm run dev

# 3. –û–Ω–æ–≤–∏—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
# (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ)

# 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
# –ü–µ—Ä–µ–π—Ç–∏: http://localhost:5173/settings/admin
# –†–æ–∑–¥—ñ–ª: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤"
```

## ‚ú® –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:

- ‚úÖ **–ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å** - –ø—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è 0 (–ø–æ–ª—É–Ω—ñ—á—å)
- ‚úÖ **–ë–µ–∑–ø–µ—á–Ω—ñ—Å—Ç—å** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
- ‚úÖ **–ö–µ—à** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à—É—î—Ç—å—Å—è, –∫–µ—à —ñ–Ω–≤–∞–ª—ñ–¥—É—î—Ç—å—Å—è –ø—Ä–∏ –∑–º—ñ–Ω–∞—Ö
- ‚úÖ **UX** - –∑—Ä–æ–∑—É–º—ñ–ª–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è–º–∏ —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è** - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

## üêõ –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è:

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Å—É –≤ –ë–î:
```sql
SELECT * FROM settings_base WHERE key = 'reporting_day_start_hour';
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ó–≤—ñ—Ç–∏ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å—Å—è"
**–†—ñ—à–µ–Ω–Ω—è:** 
1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –æ—á–∏—â–µ–Ω–æ –∫–µ—à (`?sync=true`)
2. –ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `dayStartHour` –≤ `/api/settings/reporting-day-start-hour`

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –Ω–∞ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∞—Ö"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä

## üìû –ö–æ–Ω—Ç–∞–∫—Ç–∏ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏:

–ü—Ä–∏ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º –∑–≤–µ—Ä—Ç–∞–π—Ç–µ—Å—å –¥–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ:
- –ü–æ–º–∏–ª–∫—É –∑ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞
- –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
- –ö—Ä–æ–∫, –ø—Ä–∏ —è–∫–æ–º—É –≤–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞
